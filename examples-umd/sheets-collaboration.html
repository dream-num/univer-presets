<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Univer Sheets Collaboration UMD</title>
        <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
        <script>
            /**
             * Starting from Univer 0.6.0, with the support for React 19[^1], UMD users may need additional adaptation.
             * It is recommended to migrate to module script[^2] and a more modern build system.
             *
             * [^1]: [Module Script] https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules#applying_the_module_to_your_html
             * [^2]: [support for React 19] https://github.com/dream-num/univer/pull/4247
             */

            /**
             * Fix `Uncaught TypeError: client.createRoot is not a function`
             * If using UMD React < 18, you might need the following code.
             */
            (function (global) {
                'use strict';
                if (!global.ReactDOM) {
                    throw new Error('ReactDOM must be loaded before ReactCreateRoot.');
                }
                var ReactDOM = global.ReactDOM;
                if (!ReactDOM.createRoot) {
                    ReactDOM.createRoot = function (container) {
                        return {
                            render: (element) => {
                                ReactDOM.render(element, container);
                            },
                        };
                    };
                }
            })(this);

            /**
             * Fix `Uncaught TypeError: jsxRuntime.jsx is not a function`
             * If using UMD React, you might need the following code.
             * Reference: https://unpkg.com/react@18.3.1/cjs/react-jsx-runtime.production.min.js
             */
            (function (global) {
                'use strict';
                if (!global.React) {
                    throw new Error('React must be loaded before ReactJSXRuntime.');
                }
                var React = global.React;
                if (!React.jsx || !React.jsxs) {
                    var REACT_ELEMENT_TYPE = Symbol.for('react.element');
                    var hasOwnProperty = Object.prototype.hasOwnProperty;
                    var RESERVED_PROPS = {
                        key: true,
                        ref: true,
                        __self: true,
                        __source: true,
                    };
                    var ReactCurrentOwner = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner;
                    function createReactElement(type, config, maybeKey) {
                        var props = {};
                        var key = null;
                        var ref = null;
                        if (maybeKey !== undefined) {
                            key = '' + maybeKey;
                        }
                        if (config.key !== undefined) {
                            key = '' + config.key;
                        }
                        if (config.ref !== undefined) {
                            ref = config.ref;
                        }
                        for (var propName in config) {
                            if (hasOwnProperty.call(config, propName) && !RESERVED_PROPS.hasOwnProperty(propName)) {
                                props[propName] = config[propName];
                            }
                        }
                        if (type && type.defaultProps) {
                            var defaultProps = type.defaultProps;
                            for (var propName in defaultProps) {
                                if (props[propName] === undefined) {
                                    props[propName] = defaultProps[propName];
                                }
                            }
                        }
                        return {
                            $$typeof: REACT_ELEMENT_TYPE,
                            type: type,
                            key: key,
                            ref: ref,
                            props: props,
                            _owner: ReactCurrentOwner.current,
                        };
                    }
                    React.jsx = createReactElement;
                    React.jsxs = createReactElement;
                }
            })(this);
        </script>
        <script src="https://unpkg.com/rxjs@7/dist/bundles/rxjs.umd.min.js"></script>
        <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>

        <script src="/packages/presets/lib/umd/index.js"></script>

        <script src="/packages/preset-sheets-core/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-core/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-core.css" />

        <script src="/packages/preset-sheets-drawing/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-drawing/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-drawing.css" />

        <script src="/packages/preset-sheets-advanced/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-advanced/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-advanced.css" />

        <script src="/packages/preset-sheets-data-validation/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-data-validation/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-data-validation.css" />

        <script src="/packages/preset-sheets-hyper-link/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-hyper-link/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-hyper-link.css" />

        <script src="/packages/preset-sheets-conditional-formatting/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-conditional-formatting/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-conditional-formatting.css" />

        <script src="/packages/preset-sheets-thread-comment/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-thread-comment/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-thread-comment.css" />

        <script src="/packages/preset-sheets-filter/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-filter/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-filter.css" />

        <script src="/packages/preset-sheets-find-replace/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-find-replace/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-find-replace.css" />

        <script src="/packages/preset-sheets-sort/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-sort/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-sort.css" />

        <script src="/packages/preset-sheets-collaboration/lib/umd/index.js"></script>
        <script src="/packages/preset-sheets-collaboration/lib/umd/locales/en-US.js"></script>
        <link rel="stylesheet" href="/packages/presets/lib/styles/preset-sheets-collaboration.css" />

        <style>
            html,
            body,
            #app {
                margin: 0;
                padding: 0;
                width: 100vw;
                height: 100vh;
            }
        </style>
    </head>

    <body>
        <div id="app"></div>

        <script>
            const { createUniver } = UniverPresets;
            const { LocaleType, merge } = UniverCore;
            const { defaultTheme } = UniverDesign;
            const { UniverSheetsCorePreset } = UniverPresetSheetsCore;
            const { UniverSheetsAdvancedPreset } = UniverPresetSheetsAdvanced;
            const { UniverSheetsCollaborationPreset } = UniverPresetSheetsCollaboration;

            const { UniverSheetsThreadCommentPreset } = UniverPresetSheetsThreadComment;
            const { UniverSheetsConditionalFormattingPreset } = UniverPresetSheetsConditionalFormatting;
            const { UniverSheetsDataValidationPreset } = UniverPresetSheetsDataValidation;
            const { UniverSheetsDrawingPreset } = UniverPresetSheetsDrawing;
            const { UniverSheetsFilterPreset } = UniverPresetSheetsFilter;
            const { UniverSheetsFindReplacePreset } = UniverPresetSheetsFindReplace;
            const { UniverSheetsSortPreset } = UniverPresetSheetsSort;
            const { UniverSheetsHyperLinkPreset } = UniverPresetSheetsHyperLink;

            const { UniverInstanceType } = window.UniverCore;

            const UNIVER_SERVER_ENDPOINT = location.origin;

            const collaboration = true;

            const { univerAPI, univer } = createUniver({
                locale: LocaleType.EN_US,
                locales: {
                    [LocaleType.EN_US]: merge(
                        {},
                        UniverPresetSheetsCoreEnUS,
                        UniverPresetSheetsAdvancedEnUS,
                        UniverPresetSheetsCollaborationEnUS,
                        UniverPresetSheetsThreadCommentEnUS,
                        UniverPresetSheetsConditionalFormattingEnUS,
                        UniverPresetSheetsDataValidationEnUS,
                        UniverPresetSheetsDrawingEnUS,
                        UniverPresetSheetsFilterEnUS,
                        UniverPresetSheetsFindReplaceEnUS,
                        UniverPresetSheetsHyperLinkEnUS,
                        UniverPresetSheetsSortEnUS,
                        // UniverPresetSheetsZenEditorEnUS,
                    ),
                },
                collaboration,
                // logLevel: LogLevel.VERBOSE,
                theme: defaultTheme,
                presets: [
                    UniverSheetsCorePreset({
                        container: 'app',
                        header: true,
                        footer: true,
                        // workerURL: new Worker(new URL(workerURL, import.meta.url), {
                        //   type: 'module',
                        // }),
                    }),
                    UniverSheetsDrawingPreset({
                        collaboration,
                    }),
                    UniverSheetsAdvancedPreset({
                        // useWorker: false,
                        // if univer page is not in the same domain as the server, you need to set the following parameters
                        UNIVER_SERVER_ENDPOINT,
                        // if you want to use the no-limit business feature, you can get 30-day trial license from https://univer.ai/pro/license
                        // eslint-disable-next-line node/prefer-global/process
                        // license: 'your license.txt',
                    }),

                    UniverSheetsHyperLinkPreset(),
                    UniverSheetsDataValidationPreset(),
                    UniverSheetsThreadCommentPreset({
                        collaboration,
                    }),
                    UniverSheetsConditionalFormattingPreset(),
                    UniverSheetsFilterPreset(),
                    UniverSheetsFindReplacePreset(),
                    UniverSheetsSortPreset(),

                    UniverSheetsCollaborationPreset(),
                ],
                plugins: [
                    // UniverSheetsCrosshairHighlightPlugin,
                    // UniverSheetsZenEditorPlugin,
                ],
            });

            window.univerAPI = univerAPI;
            const injector = univer.__getInjector();
        </script>
    </body>
</html>
